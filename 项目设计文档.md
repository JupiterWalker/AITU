# 项目名称：基于 LLM 与知识图谱的通用学习工具

## 🧭 项目目标

构建一个结合大语言模型（LLM）与知识图谱（KG）的交互式学习工具，帮助用户围绕某个“主题”进行头脑风暴式探索和总结，避免上下文 token 冗余、保持对话聚焦，并实现知识跨主题联通。

---

## 🎯 项目核心功能

### 1. **主题化学习结构**
- 每次新对话即创建一个新“主题”节点（根节点）。
- 用户可围绕该主题逐步展开提问，延展出知识树/图。

### 2. **LLM 问答驱动节点扩展**
- 用户可点击任意节点并输入子问题。
- 可选：调用 LLM（如 GPT-4）生成回答，构造新节点。
- 节点自动组织为树状/图状结构。

### 3. **上下文管理与 token 节省**
- 使用图谱结构代替线性长对话上下文。
- 每次提问仅调取当前节点及其上下文分支内容。
- 显著节省 token 成本，提升响应质量。

### 4. **跨主题关联（任督二脉提示）**
- 新生成的节点将被语义向量化。
- 若与其他主题中节点语义相似，系统提示“知识打通”。
- 用户可选择建立跨主题连接。

### 5. **多用户支持**
- 每位用户有独立的主题集合与图谱。
- 支持未来用户画像、偏好定制等扩展。

### 6. **可视化图谱交互（React Flow）**
- 使用 React Flow 展示主题图谱。
- 节点可点击、拖动、展开。
- 输入区固定在底部，支持多行编辑与扩展输入。

---

## 🧱 技术架构与选型（MVP 阶段）

### 前端
- **框架**：React + TypeScript
- **图谱渲染**：React Flow
- **样式**：Tailwind CSS

### 后端
- **服务框架**：FastAPI（Python）
- **向量搜索**：FAISS（本地向量检索）
- **LLM 接入**：OpenAI API（GPT-4 或 GPT-3.5）

### 数据存储
- **图谱数据**：SQLite（包含主题、节点、关系）
- **向量索引**：FAISS（内存级向量搜索）

---

## 🛠️ 后端服务（FastAPI）

### API 路由建议：

| 功能                     | 路由（建议）              |
|--------------------------|---------------------------|
| 提交用户问题             | `POST /ask`               |
| 获取主题的图谱结构       | `GET /graph/{theme_id}`   |
| 检查新节点的跨主题关联   | `POST /check-link`        |
| 保存新节点及更新图谱     | `POST /update-graph`      |



🔗 FAISS（内存向量库）
初始化时载入所有节点向量；

每次新节点生成时：

向量化并添加到 FAISS；

查询是否有高相似度节点；

返回相关节点 + 所属主题用于“打通提示”。



## 🧩 数据结构设计（简化）

### 表：themes
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id     | UUID | 主题 ID |
| title  | TEXT | 主题标题 |
| created_at | DATETIME | 创建时间 |

### 表：nodes
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id         | UUID | 节点 ID |
| theme_id   | UUID | 所属主题 |
| parent_id  | UUID | 父节点 ID（根为 NULL）|
| content    | TEXT | 节点文本 |
| embedding  | BLOB | 向量表示（用于关联）|
| created_at | DATETIME | 时间戳 |

---

## 🔁 主流程回顾

1. 用户输入问题，创建新主题与根节点；
2. 用户点击任意节点，输入子问题；
3. 生成回答（手动或 LLM），添加子节点；
4. 新节点向量化并保存，触发关联检测；
5. 若与其他主题节点相似，提示“任督二脉打通”；
6. 用户可继续扩展或切换主题查看历史知识图谱。

---

## 📌 MVP 实现进度

✅ React Flow 图谱可视化 + 节点点击输入区
✅ 节点支持多行编辑、固定底部显示
✅ 节点生成与树结构更新
🔜 接入 GPT 自动生成回答
🔜 保存图谱到 SQLite
🔜 语义向量化 + 任督二脉提示

---

如需详细模块划分、任务分阶段实施计划，可继续扩展此文档。

